<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">

	<title>New Vector Types - TiPi framework</title>

        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="..">TiPi framework</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../framework/">Framework</a>
</li>

                        
                            
<li >
    <a href="../shaped-arrays/">Shaped Arrays</a>
</li>

                        
                            
<li >
    <a href="../array-factory/">Making Arrays</a>
</li>

                        
                            
<li >
    <a href="../vectors/">Vectors</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developpers <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li class="active">
    <a href="./">New Vector Types</a>
</li>

                        
                            
<li >
    <a href="../tpp/">The TiPi Preprocessor</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../license/">License</a>
</li>

                        
                            
<li >
    <a href="../news/">News</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../vectors/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../tpp/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#creating-new-vector-types-in-tipi">Creating new vector types in TiPi</a></li>
        
            <li><a href="#methods-that-must-be-overridden">Methods that must be overridden</a></li>
        
            <li><a href="#methods-with-default-implementation">Methods with default implementation</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="creating-new-vector-types-in-tipi">Creating new vector types in TiPi</h1>
<p>For now TiPi only provides two concrete types of vectors, <code>DoubleShapedVector</code>
and <code>FlaotShapedVector</code>, with their respective vector spaces classes,
<code>DoubleShapedVectorSpace</code> and <code>FloatShapedVectorSpace</code>.  Such vectors store
their components in a single Java array of type <code>double[]</code> or <code>float[]</code> and are
closely connected to <code>ShapedArray</code> (<em>i.e.</em>, they also have a <em>shape</em>).  For
very large problems, it may be more convenient to store the components of the
vectors differently, perhaps on different machines and/or in GPU memory.  It is
possible (and hopefully easy) to make TiPi aware of this specific storage by
implementing the corresponding vector and vector space classes.  Another reason
to create a new vector and vector space type may be to provide more efficient
(<em>e.g.</em>, multi-threaded) versions of the methods designed to operate on
vectors.</p>
<p>Implementing a new type of vectors in TiPi involves two things:</p>
<ol>
<li>
<p>A concrete sub-class of <code>Vector</code> for the vectors of this vector space.  This
   can be as simple as implementing the two methods <code>get()</code> and <code>set()</code> for
   getting and setting a specific component of a vector.  These methods are not
   meant to be efficient, they are mainly provided for testing or debugging
   purposes.</p>
</li>
<li>
<p>A concrete sub-class of <code>VectorSpace</code> for the vector space.  Only a dozen of
   methods which operate on the specifc vectors of this vector space have to be
   implemented.  These methods are assumed to be efficient and are used by TiPi
   to perform all necessary operations on vectors.</p>
</li>
</ol>
<p>All methods whose name begins with an underscore character, <em>e.g.</em> <code>_dot</code>, are
low-level <code>protected</code> methods which must not be directly called by the
end-user.  They are used by higher level methods which take care of checking
the validity of the arguments, in particular that the vectors belong to the
correct vector space.  Thus in the implementation of these low level methods no
argument checking is necessary.</p>
<p>Even though vectors can use any type of floating point values to store their
components, all scalar values in TiPi are passed as double precision floating
point.</p>
<h3 id="methods-that-must-be-overridden">Methods that must be overridden</h3>
<p>A concrete implementation of the <code>Vector</code> class has to override the following
methods:</p>
<ul>
<li>
<p>Method <code>public double get(int i) throws IndexOutOfBoundsException</code> yields
  the value of the component at index <code>i</code> of the vector.</p>
</li>
<li>
<p>Method <code>public void set(int i, double val) throws IndexOutOfBoundsException</code>
  set the component at index <code>i</code> of the vector to the value <code>val</code>.</p>
</li>
</ul>
<p>As said before, these two methods are not meant to be efficient, they are
mainly provided for testing or debugging purposes.  This is not the case for
the methods of the concrete implementation of the <code>VectorSpace</code> class described
below.</p>
<p>A concrete implementation of the <code>VectorSpace</code> class has to override the
following mandatory methods:</p>
<ul>
<li>
<p>Method <code>public Vector create()</code> creates a new vector of the vector space with
  undefined contents.</p>
</li>
<li>
<p>Method <code>protected void _swap(Vector x, Vector y)</code> exchange the contents of
  the two vectors <code>x</code> and <code>y</code>.</p>
</li>
<li>
<p>Method <code>protected void _fill(Vector vec, double alpha)</code> set all components of
  vector <code>vec</code> to the value <code>alpha</code>.</p>
</li>
<li>
<p>Method <code>protected void _scale(Vector dst, double alpha, Vector src)</code> for
  scaling the components of vector <code>src</code> by the scalar <code>alpha</code> and store the
  result in vector <code>dst</code>.</p>
</li>
<li>
<p>Method <code>protected double _dot(Vector x, Vector y)</code> computes the inner
  product of the two vectors <code>x</code> and <code>y</code>, that is the sum of the products of
  the corresponding components of the two vectors.</p>
</li>
<li>
<p>Method <code>protected double _dot(Vector w, Vector x, Vector y)</code> computes the
  inner product of three vectors or the weighted inner product of two vectors.</p>
</li>
<li>
<p>Method <code>protected double _norm1(Vector x)</code> computes the L1 norm of the vector
  <code>x</code>, that is the sum of absolute values of the components of <code>x</code>.</p>
</li>
<li>
<p>Method <code>protected double _normInf(Vector x)</code> computes the infinite norm of
  the vector <code>x</code>, that is the maximum absolute value of the components of <code>x</code>.</p>
</li>
<li>
<p>Method <code>protected void _multiply(Vector dst, Vector x, Vector y)</code> performs a
  component-wise multiplication of two vectors: <code>dst[i] = x[i]*y[i]</code> (for all
  <code>i</code>).  This method is used to implement diagonal operators.</p>
</li>
<li>
<p>Method <code>protected void _combine(Vector dst, double alpha, Vector x, double
  beta, Vector y)</code> computes the linear combination of two vectors: <code>dst[i] =
  alpha*x[i] + beta*x[i]</code> (for all <code>i</code>).  As this method can be used to emulate
  other operations (as <code>copy</code>, <code>zero</code>, <em>etc.</em>), actual code should be optimized
  for specific factors <code>alpha</code> and/or <code>beta</code> equal to +/-1 or 0.  In particular
  when <code>alpha</code> (resp. <code>beta</code>) is zero, then <code>x</code> (resp. <code>y</code>) must not be
  referenced.</p>
</li>
<li>
<p>Method <code>protected void _combine(Vector dst, double alpha, Vector x, double
  beta, Vector y, double gamma, Vector z)</code> computes the linear combination of
  three vectors: <code>dst[i] = alpha*x[i] + beta*x[i] + gamma*z[i]</code> (for all <code>i</code>).
  As this method can be used to emulate other operations (as <code>copy</code>, <code>zero</code>,
  <em>etc.</em>), actual code should be optimized for specific factors <code>alpha</code> and/or
  <code>beta</code> equal to +/-1 or 0.  In particular when <code>alpha</code> (resp. <code>beta</code> or
  <code>gamma</code>) is zero, then <code>x</code> (resp. <code>y</code> or <code>z</code>) must not be referenced.</p>
</li>
</ul>
<h3 id="methods-with-default-implementation">Methods with default implementation</h3>
<p>The following methods have a default implementation which can be overridden
with more efficient versions by the descendants of the <code>VectorSpace</code> abstract
class:</p>
<ul>
<li>Method <code>protected double _norm2(Vector x)</code> computes the Euclidean (L2) norm
  of the vector <code>x</code>, that is the square root of the sum of squared components
  of <code>x</code>.  The following default implementation is provided:</li>
</ul>
<pre><code class="java">protected double _norm2(Vector x) {
    return Math.sqrt(_dot(x, x));
}
</code></pre>

<ul>
<li>Method <code>protected void _scale(Vector vec, double alpha)</code> for in-place scaling
  of vector <code>vec</code> by the scalar <code>alpha</code> has the following default
  implementation:</li>
</ul>
<pre><code class="java">protected void _scale(Vector vec, double alpha) {
    _scale(vec, alpha, vec);
}
</code></pre>

<ul>
<li>Method <code>protected void _copy(Vector dst, Vector src)</code> copies the contents of
  a vector into another one: <code>dst[i] = src[i]</code> (for all <code>i</code>) with the following
  default implementation:</li>
</ul>
<pre><code class="java">protected void _copy(Vector dst, Vector src) {
    _combine(dst, 1, src, 0, src);
}
</code></pre>

<ul>
<li>Method <code>protected Vector _clone(Vector vec)</code> creates a new vector as a clone
  of another vector, it has the following default implementation:</li>
</ul>
<pre><code class="java">protected Vector _clone(Vector vec) {
    Vector cpy = create();
    _copy(cpy, vec);
    return cpy;
}
</code></pre>

<ul>
<li>Method <code>protected void _zero(Vector vec)</code> to set to zero all components of
  vector <code>vec</code> has the following default implementation:</li>
</ul>
<pre><code class="java">protected void _zero(Vector vec) {
    _fill(vec, 0);
}
</code></pre>

<ul>
<li>Method <code>protected void _add(Vector dst, double alpha, Vector x)</code> adds <code>alpha</code>
  times <code>x</code> to <code>dst</code>: <code>dst[i] += alpha*x[i]</code> and has the following default
  implementation:</li>
</ul>
<pre><code class="java">protected void _add(Vector dst, double alpha, Vector x) {
    _combine(dst, 1, dst, alpha, x);
}
</code></pre></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script>var base_url = '..';</script>
        <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
        <script src="../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>
